*** Settings ***
Library           Selenium2Library
Library           Collections
Library           OperatingSystem
Library           MyLibrary
Library           String
Library           EmailLibrary

*** Variables ***
${CUSTOMERNAME}    DANTE
${REPORTDIR}      C:\\tmp\\ASWorkbench\\WebTesting\\
${REPODIR}        C:\\tmp\\ASWorkbench\\Repo\\
${CUSTOMERNAME}    DANTE
${REPORTDIR}      C:\\tmp\\ASWorkbench\\WebTesting\\
${REPODIR}        C:\\tmp\\ASWorkbench\\Repo\\
${CONTRACT_TAB}    1
${INVENTORY_TAB}    2
${FRU_TAB}         3
${SOFTWARE_ANALYSIS_TAB}    4
${EOL_TAB}        5
${CONTRACT_FILTER_COLUMN_TAB}    2
${INVENTORY_FILTER_COLUMN_TAB}    2
${FRU_FILTER_COLUMN_TAB}    3
${SOFTWARE_ANALYSIS_FILTER_COLUMN_TAB}    2
${EOL_FILTER_COLUMN_TAB}    2
${CONTRACT_FILTER_DATA_TAB}    2
${INVENTORY_FILTER_DATA_TAB}    Chassis
${FRU_FILTER_DATA_TAB}    mx480
${SOFTWARE_ANALYSIS_FILTER_DATA_TAB}    mx480
${EOL_FILTER_DATA_TAB}    2
*** Test Cases ***
abc
    [Tags]    abc
    Close All Browsers
    Selenium2Library.Open Browser    http://localhost/a.html
    sleep    2
    ${a}=    Selenium2Library.Execute Javascript    ${CURDIR}/scroll.js
    log    ${a}

def
    [Tags]    w
    Prepare File For Inventory Mapping    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv
    Compare Inventory    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventory.csv    ${REPODIR}${CUSTOMERNAME}_inventory.csv

Login to SM Workbench
    [Tags]    common
    Close All Browsers
    Selenium2Library.Open Browser    http://d-jss-app.jnpr.net:50080/jss-ciat/app/home    firefox
    Comment    Maximize Browser Window
    Input Text    j_username    demo
    Input Password    j_password    demo
    Click Button    submit
    Page Should Contain    Welcome

Navigate to SM Workbench Page
    [Tags]    common
    Mouse Over    externalNav
    Click Element    xpath=//li[@id="smWorkbenchNav"]/a
    sleep    10
    #Page Should Contain    Account Selector
    Page Should Contain    Inventories

Verify Tabs Loading
    [Tags]    common
    Sleep    2
    Select Frame    id=smWorkbenchPage
    sleep    4
    Input Text    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/div/div[1]/div/oi-select/div[1]/ul/li[1]/input    ${CUSTOMERNAME}
    sleep    2
    Click Element    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/div/div[1]/div/oi-select/div[2]/ul/li
    sleep    3
    Element Should Be Visible    //button[starts-with(@class, 'md-raised')]/span[contains(text(), "Download")]
    Sleep    3
    ${firstVal}=    Get Text    //md-tab-item[1][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${seconVal}=    Get Text    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${thirdVal}=    Get Text    //md-tab-item[3][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${fourthVal}=    Get Text    //md-tab-item[4][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${fifthVal}=    Get Text    //md-tab-item[5][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Should Be Equal    ${firstVal}    CONTRACT
    Should Be Equal    ${seconVal}    INVENTORY
    Should Be Equal    ${thirdVal}    FRU TO CHASSIS MAP
    Should Be Equal    ${fourthVal}    SOFTWARE ANALYSIS
    Should Be Equal    ${fifthVal}    EOL

Verify INVENTORY Table Header Information
    [Tags]    i
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    Sleep    2
    Should Be Equal    ${Device Name}    Device Name
    Should Be Equal    ${Module}    Module
    Should Be Equal    ${Sub Module}    Sub Module
    Should Be Equal    ${Sub Sub Module}    Sub Sub Module
    Should Be Equal    ${Sub Sub Sub Module}    Sub Sub Sub Module
    Should Be Equal    ${Part Number}    Part Number
    Should Be Equal    ${Model Number}    Model Number
    Should Be Equal    ${Serial Number}    Serial Number
    Should Be Equal    ${Product}    Product
    Should Be Equal    ${Platform}    Platform
    Should Be Equal    ${Revision}    Revision
    Should Be Equal    ${Description}    Description

Verify INVENTORY Filtering based on Module
    [Tags]    if
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Click Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[${INVENTORY_FILTER_COLUMN_TAB}]/span
    Sleep    5
    Wait Until Element Is Visible    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    ${INVENTORY_FILTER_DATA_TAB}
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    log    pages = ${pages}    WARN
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    ${INVENTORY_TAB}
    \    Log    Page ${page} contains ${page_rows} rows    WARN
    \    checkFilters    ${INVENTORY_TAB}   ${page_rows}    ${INVENTORY_FILTER_COLUMN_TAB}    ${INVENTORY_FILTER_DATA_TAB}
    \    ${tmp}    Evaluate    ${page}+1
    \    Run keyword If    ${tmp}==${pages}    Exit For Loop
    \    Click Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    #\    Run Keyword If    ${page}<=${pages}+1    Exit For Loop

Verify INVENTORY Data
    [Tags]    i
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Create File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv
    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv    [u'Device Name', u'Module', u'Sub_Module', u'Sub_Sub_Module', u'Sub_Sub_Sub_Module', u'Part Number', u'Revision', u'Model Number', u'Serial Number', u'Description']
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Clicking Menu For Expanding Rows    WARN
    \    Mouse Over    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-trigger/button
    \    Log    Expanding Rows    WARN
    \    Sleep    4
    \    Click Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button
    \    Sleep    5
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    ${INVENTORY_TAB}
    \    Log    TotalPageRows = ${page_rows}    WARN
    \    Log    Getting Page Rows    WARN
    \    Run Keyword    getInventoryDivTableRow    ${page_rows}
    \    Sleep    3
    \    Log    Clicking Menu For collapsing Rows    WARN
    \    Mouse Over    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-trigger/button
    \    Log    Collapsing Rows    WARN
    \    Sleep    4
    \    Wait Until Page Contains Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button    timeout=30
    \    Click Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button
    \    Log    Loading ${page} Page    WARN
    \    Sleep    5
    \    Click Element    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    \    Sleep    3
    \    #Run Keyword If    ${page}>=1    Exit For Loop
    Prepare File For Inventory Mapping    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv
    Compare Inventory    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventory.csv    ${REPODIR}${CUSTOMERNAME}_inventory.csv

Verify FRU To Chassis Map Table Header Information
    [Tags]    f
    Click Element    //md-tab-item[3][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${Parent Chassis Name}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Parent Chassis Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Parent Chassis Type}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Component Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Component Part Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    ${Component Model Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[6]/div[2]/span[2]
    Sleep    2
    Should Be Equal    ${Parent Chassis Name}    Parent Chassis Name
    Should Be Equal    ${Parent Chassis Serial Number}    Parent Chassis Serial Number
    Should Be Equal    ${Parent Chassis Type}    Parent Chassis Type
    Should Be Equal    ${Component Serial Number}    Component Serial Number
    Should Be Equal    ${Component Part Number}    Component Part Number
    Should Be Equal    ${Component Model Number}    Component Model Number

Verify FRU TO CHASSIS MAP Filtering based on "Parent Chassis Type"
    [Tags]    ff
    Click Element    //md-tab-item[${FRU_TAB}][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Click Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[${FRU_FILTER_COLUMN_TAB}]/span
    Sleep    5
    Wait Until Element Is Visible    //md-tab-content[@id="tab-content-3"]/div/div/md-content/div/md-content/div/div/div/div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    ${FRU_FILTER_DATA_TAB}
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${Parent Chassis Name}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Parent Chassis Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Parent Chassis Type}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Component Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Component Part Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    ${Component Model Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[6]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    log    pages = ${pages}    WARN
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    ${FRU_TAB}
    \    Log    Page ${page} contains ${page_rows} rows    WARN
    \    checkFilters    ${FRU_TAB}   ${page_rows}    ${FRU_FILTER_COLUMN_TAB}    ${FRU_FILTER_DATA_TAB}
    \    ${tmp}    Evaluate    ${page}+1
    \    Run keyword If    ${tmp}==${pages}    Exit For Loop
    \    Click Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    #\    Run Keyword If    ${page}<=${pages}+1    Exit For Loop

Verify FRU To Chassis Map Data
    [Tags]    f
    Click Element    //md-tab-item[3][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Create File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv
    #Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv    [u'Parent Chassis Name', u'Parent Chassis Serial Number', u'Parent Chassis Type', u'Component Serial Number', u'Component Part Number', u'Component Model Number']
    ${Parent Chassis Name}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Parent Chassis Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Parent Chassis Type}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Component Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Component Part Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    ${Component Model Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[6]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Clicking Menu For Expanding Rows    WARN
    \    Mouse Over    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-trigger/button
    \    Log    Expanding Rows    WARN
    \    Sleep    4
    \    Click Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button
    \    Sleep    5
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    ${FRU_TAB}
    \    Log    TotalPageRows = ${page_rows}    WARN
    \    Log    Getting Page Rows    WARN
    \    Run Keyword    getFRUDivTableRow    ${page_rows}
    \    Sleep    3
    \    Log    Clicking Menu For collapsing Rows    WARN
    \    Mouse Over    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-trigger/button
    \    Log    Collapsing Rows    WARN
    \    Sleep    4
    \    Wait Until Page Contains Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button    timeout=30
    \    Click Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[2]/md-fab-speed-dial/md-fab-actions/div[3]/button
    \    Log    Loading ${page} Page    WARN
    \    Sleep    5
    \    Click Element    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    \    Sleep    3
    \    #Run Keyword If    ${page}>=1    Exit For Loop
    Prepare File For FRU Mapping    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv
    Compare FRU To Chassis    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRU.csv    ${REPODIR}${CUSTOMERNAME}_FRU-to-Chassis.csv

Verify Software Analysis Table Header Information
    [Tags]    s
    Click Element    //md-tab-item[${SOFTWARE_ANALYSIS_TAB}][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Product}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Junos Version}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    Sleep    2
    Should Be Equal    ${Device Name}    Device Name
    Should Be Equal    ${Product}    Product
    Should Be Equal    ${Platform}    Platform
    Should Be Equal    ${Serial Number}    Serial Number
    Should Be Equal    ${Junos Version}    Junos Version

Verify SOFTWARE ANALYSIS Filtering based on "Product"
    [Tags]    sf
    Click Element    //md-tab-item[${SOFTWARE_ANALYSIS_TAB}][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Click Element    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[${SOFTWARE_ANALYSIS_FILTER_COLUMN_TAB}]/span
    Sleep    5
    Wait Until Element Is Visible    //md-tab-content[@id="tab-content-4"]/div/div/md-content/div/md-content/div/div/div/div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    ${SOFTWARE_ANALYSIS_FILTER_DATA_TAB}
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Product}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Junos Version}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    log    pages = ${pages}    WARN
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    ${SOFTWARE_ANALYSIS_TAB}
    \    Log    Page ${page} contains ${page_rows} rows    WARN
    \    checkFilters    ${SOFTWARE_ANALYSIS_TAB}   ${page_rows}    ${SOFTWARE_ANALYSIS_FILTER_COLUMN_TAB}    ${SOFTWARE_ANALYSIS_FILTER_DATA_TAB}
    \    ${tmp}    Evaluate    ${page}+1
    \    Run keyword If    ${tmp}==${pages}    Exit For Loop
    \    Click Element    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    #\    Run Keyword If    ${page}<=${pages}+1    Exit For Loop

Verify Software Analysis Data
    [Tags]    s
    Click Element    //md-tab-item[4][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Create File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingSoftwareAnalysisTmp.csv
    #Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv    [u'Parent Chassis Name', u'Parent Chassis Serial Number', u'Parent Chassis Type', u'Component Serial Number', u'Component Part Number', u'Component Model Number']
    ${Device Name}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[1]/div[2]/span[4]
    ${Product}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[3]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[4]/div[2]/span[2]
    ${Junos Version}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div[4]/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[5]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    : FOR    ${page}    IN RANGE    0    ${pages}
    \    Log    Getting Page Rows Count    WARN
    \    ${page_rows}    Run Keyword    getPageRows    4
    \    Log    TotalPageRows = ${page_rows}    WARN
    \    Log    Getting Page Rows    WARN
    \    Run Keyword    getSoftwareAnalysisDivTableRow    ${page_rows}
    \    Sleep    3
    \    Log    Loading ${page} Page    WARN
    \    Sleep    5
    \    Click Element    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    \    Sleep    3
    \    #Run Keyword If    ${page}>=1    Exit For Loop
    Prepare File For Software Analysis Mapping    ${REPORTDIR}${CUSTOMERNAME}-WebTestingSoftwareAnalysisTmp.csv
    Compare Software Analysis    ${REPORTDIR}${CUSTOMERNAME}-WebTestingSoftwareAnalysis.csv    ${REPODIR}${CUSTOMERNAME}_software_analysis.csv

Verify INVENTORY Columns Settings
    [Tags]    ia
    Sleep    4
    Mouse Over    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-trigger/button
    #Wait Until Element Is Visible    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    Sleep    4
    Click Button    //div[@layout="column"]/md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    ${settings_columns_header}    Get Text    //div[@id="east"]/div/div/div/div/div
    ${number_of_columns}    Get Matching Xpath Count    //div[@id="east"]/div/div/div/div/div/div/div/span/span[2]
    ${serialId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[1]/span/span[2]
    ${contractId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[2]/span/span[2]
    ${product}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[3]/span/span[2]
    ${platform}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[4]/span/span[2]
    ${sku}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[5]/span/span[2]
    ${skuClassification}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[6]/span/span[2]
    ${status}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[7]/span/span[2]
    ${startDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[8]/span/span[2]
    ${endDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[9]/span/span[2]
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date

Verify INVENTORY Column Selection
    [Tags]    ia
    # Disabling all columns
    Log    Disabling all columns
    Sleep    4
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Should Not Be Equal    ${contractId}    Contract Id
    Should Not Be Equal    ${product}    Product
    Should Not Be Equal    ${platform}    Platform
    Should Not Be Equal    ${sku}    SKU
    Should Not Be Equal    ${skuClassification}    SKU Classification
    Should Not Be Equal    ${status}    Status
    Should Not Be Equal    ${startDate}    Start Date
    Should Not Be Equal    ${endDate}    End Date
    Sleep    3
    Log    Enable all columns
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    # Disable column "Serial Id"
    Log    Disabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Sleep    3
    Log    Enabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3

Verify CONTRACT Table Header Information
    [Tags]    c
    Click Element    //md-tab-item[1][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    ${count}=    Get Text    //div[@id="south"]/div/span/span[3]
    Sleep    2
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date
    #Should Be Equal    ${count}    Count

Verify CONTRACT Filtering based on Product
    [Tags]    c
    Sleep    5
    Click Element    //div[@id="borderLayout_eGridPanel"]/div/div/div/div/div/div[3]/span[@class="ag-header-cell-menu-button"]
    Sleep    5
    Wait Until Element Is Visible    //div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    srx
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[1]/span
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[2]/span
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[3]/span
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[4]/span
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[5]/span
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[6]/span
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[7]/span
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[8]/span
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[9]/span
    ${count}=    Get Text    //div[@id="south"]/div/span/span[3]
    ${pages}=    Get Text    //div[@id="south"]/div/span[2]/span[2]
    : FOR    ${page}    IN RANGE    1    ${pages}\
    \    getDivTableRow
    \    Click Element    //div[@id="south"]/div/span[2]/button[@id="btNext"]
    \    Sleep    5
    \    Run Keyword If    ${pages}<${pages}    Exit For Loop

Verify CONTRACT Columns Settings
    [Tags]    c
    Sleep    4
    Mouse Over    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-trigger/button
    #Wait Until Element Is Visible    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    Sleep    4
    Click Button    //div[@layout="column"]/md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    ${settings_columns_header}    Get Text    //div[@id="east"]/div/div/div/div/div
    ${number_of_columns}    Get Matching Xpath Count    //div[@id="east"]/div/div/div/div/div/div/div/span/span[2]
    ${serialId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[1]/span/span[2]
    ${contractId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[2]/span/span[2]
    ${product}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[3]/span/span[2]
    ${platform}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[4]/span/span[2]
    ${sku}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[5]/span/span[2]
    ${skuClassification}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[6]/span/span[2]
    ${status}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[7]/span/span[2]
    ${startDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[8]/span/span[2]
    ${endDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[9]/span/span[2]
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date

Verify CONTRACT Column Selection
    [Tags]    c
    # Disabling all columns
    Log    Disabling all columns
    Sleep    4
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Should Not Be Equal    ${contractId}    Contract Id
    Should Not Be Equal    ${product}    Product
    Should Not Be Equal    ${platform}    Platform
    Should Not Be Equal    ${sku}    SKU
    Should Not Be Equal    ${skuClassification}    SKU Classification
    Should Not Be Equal    ${status}    Status
    Should Not Be Equal    ${startDate}    Start Date
    Should Not Be Equal    ${endDate}    End Date
    Sleep    3
    Log    Enable all columns
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    # Disable column "Serial Id"
    Log    Disabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Sleep    3
    Log    Enabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3

Verify Graph
    Comment    Mouse Over    //*/div[@id='pieChart']
    Sleep    3
    Comment    Selenium2Library.Wait Until Element Is Visible    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/md-tabs/md-tabs-content-wrapper/md-tab-content[1]/div/md-content/div[2]/div[1]/div[1]/svg
    ${entitleInfo}=    Get Element Attribute    xpath= //*/div[@id='pieChart']/*[name()='svg']/*[name()='g']/*[name()='g']/*[name()='path']@fill
    Log    ${entitleInfo}    WARN
    Should Be Equal    ${entitleInfo}    ACTIVE: 100%
    Comment    ${totalActive}=    Get Text    xpath=//*/div[@id='pieChart']/*[name()='svg']/*[name()='g']/*[name()='g']/*[name()='text']
    Should Be Equal    ${totalActive}    ACTIVE(1219)
    ${bar}=    Set Variable    31
    : FOR    ${count}    IN RANGE    ${bar}+1
    \    ${number}=    Get Text    //div[@id='barChart']//*[local-name() = 'svg']/*[name()='g'][1]/*[name()='text'][${count}]
    \    ${model}=    Get Text    //div[@id='barChart']//*[local-name() = 'svg']/*[name()='g'][2]/*[name()='text'][${count}]
    \    ${LOG_FILE}    ${model}    ${number}

Logout and Close
    Unselect Frame
    Click Link    xpath=/html/body/div[2]/div/table/tbody/tr[2]/td/a
    Wait Until Page Contains    Login    timeout=10
    Close Browser

SendMail
    Prepare Report For Email    Juniper    C:/tmp
    Send Mail With Attachment    pbiswas@juniper.net    pbiswas@juniper.net    Automation Test Results    Please find the attached results    C:/tmp/RIDE-report.zip

*** Keywords ***
getPageRows
    [Arguments]    ${tab}
    Sleep    2
    ${rows}=    Set Variable    1000
    log    Row Count = ${rows}    WARN
    Set Global Variable    ${page_rows}    0
    : FOR    ${row}    IN RANGE    0    ${rows}
    \    ${exists}=    Get Matching Xpath Count    //md-tab-content[${tab}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span    #Arrow
    \    Log    Exists= ${exists}    WARN
    \    Log    PageRowNo= ${page_rows}    WARN
    \    ${scroll_count}=    Run Keyword if    int(${row})>=30    getScrollCount    ${row}
    \    Run Keyword if    int(${row})>29    refreshTable    ${scroll_count}    ${tab}
    \    Run Keyword If    ${exists}==0    Exit For Loop
    \    ${page_rows}=    Evaluate    ${page_rows}+1
    Log    Resetting Table Scroll
    Run Keyword    resetTable    ${tab}
    Sleep    2
    Return From Keyword    ${page_rows}

refreshTable
    [Arguments]    ${scroller}    ${tab}
    #Selenium2Library.Execute Javascript    ${CURDIR}/scroll.js
    Selenium2Library.Execute Javascript    document.evaluate("//md-tab-content[${tab}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue.scrollTop = ${scroller}

resetTable
    [Arguments]    ${tab}
    Selenium2Library.Execute Javascript    document.evaluate("//md-tab-content[${tab}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue.scrollTop = 0

getScrollCount
    [Arguments]    ${row}
    ${row}    Evaluate    int(${row})-29
    ${tmp}    Evaluate    30*int(${row})
    Return From Keyword    ${tmp}

getInventoryDivTableRow
    [Arguments]    ${page_rows}
    Sleep    4
    ${rows}=    Set Variable    ${page_rows}
    ${cols}=    Set Variable    12
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    : FOR    ${row}    IN RANGE    0    ${rows}
    \    ${exists}=    Get Matching Xpath Count    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/span[3]    #Arrow
    \    ${exists1}=    Get Matching Xpath Count    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/span    #Non Arrow
    \    ${element}=    Set Variable If    ${exists}==1    span[3]    span
    \    ${element}=    Set Variable If    ${exists}==0 and ${exists1}==0    span[3]    ${element}
    \    Log    Rows= ${rows}
    \    Log    RowNo= ${row}    WARN
    \    ${Device Name}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/${element}
    \    ${Module}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[2]/span/span
    \    ${Sub Module}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[3]/span/span
    \    ${Sub Sub Module}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[4]/span/span
    \    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[5]/span/span
    \    ${Part Number}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[6]/span/span
    \    ${Model Number}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[7]/span/span
    \    ${Serial Number}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[8]/span/span
    \    ${Product}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[9]/span/span
    \    ${Platform}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[10]/span/span
    \    ${Revision}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[11]/span/span
    \    ${Description}=    Get Text    //md-tab-content[${INVENTORY_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[12]/span/span
    \    ${record}=    Create List    ${Device Name}    ${Module}    ${Sub Module}    ${Sub Sub Module}
    \    ...    ${Sub Sub Sub Module}    ${Part Number}    ${Revision}    ${Model Number}    ${Serial Number}
    \    ...    ${Description}
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv    ${record}[0]
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingInventoryTmp.csv    "\n"
    \    ${scroll_count}=    Run Keyword if    int(${row})>=30    getScrollCount    ${row}
    \    Run Keyword if    int(${row})>29    refreshTable    ${scroll_count}    2
    \    #Sleep    1

getFRUDivTableRow
    [Arguments]    ${page_rows}
    Sleep    4
    ${rows}=    Set Variable    ${page_rows}
    ${cols}=    Set Variable    12
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    : FOR    ${row}    IN RANGE    0    ${rows}
    \    ${exists}=    Get Matching Xpath Count    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/span[3]    #Arrow
    \    ${exists1}=    Get Matching Xpath Count    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/span    #Non Arrow
    \    ${element}=    Set Variable If    ${exists}==1    span[3]    span
    \    ${element}=    Set Variable If    ${exists}==0 and ${exists1}==0    span[3]    ${element}
    \    Log    Rows= ${rows}
    \    Log    RowNo= ${row}    WARN
    \    ${Parent Chassis Name}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span/span/${element}
    \    ${Parent Chassis Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[2]/span/span
    \    ${Parent Chassis Type}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[3]/span/span
    \    ${Component Serial Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[4]/span/span
    \    ${Component Part Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[5]/span/span
    \    ${Component Model Number}=    Get Text    //md-tab-content[${FRU_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[6]/span/span
    \    ${record}=    Create List    ${Component Serial Number}    ${Component Part Number}    ${Component Model Number}    ${Parent Chassis Serial Number}
    \    ...    ${Parent Chassis Type}    ${Parent Chassis Name}
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv    ${record}[0]
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingFRUTmp.csv    "\n"
    \    ${scroll_count}=    Run Keyword if    int(${row})>=30    getScrollCount    ${row}
    \    Run Keyword if    int(${row})>29    refreshTable    ${scroll_count}    3
    \    #Sleep    1

getSoftwareAnalysisDivTableRow
    [Arguments]    ${page_rows}
    Sleep    4
    ${rows}=    Set Variable    ${page_rows}
    ${cols}=    Set Variable    12
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    : FOR    ${row}    IN RANGE    0    ${rows}
    \    Log    Rows= ${rows}
    \    Log    RowNo= ${row}    WARN
    \    ${Device Name}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[1]/span/span
    \    ${Product}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[2]/span/span
    \    ${Platform}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[3]/span/span
    \    ${Serial Number}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[4]/span/span
    \    ${Junos Version}=    Get Text    //md-tab-content[${SOFTWARE_ANALYSIS_TAB}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[5]/span/span
    \    ${record}=    Create List    ${Device Name}    ${Product}    ${Serial Number}    ${Junos Version}
    \    ...    ${Platform}
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingSoftwareAnalysisTmp.csv    ${record}[0]
    \    Append To File    ${REPORTDIR}${CUSTOMERNAME}-WebTestingSoftwareAnalysisTmp.csv    "\n"
    \    ${scroll_count}=    Run Keyword if    int(${row})>=30    getScrollCount    ${row}
    \    Run Keyword if    int(${row})>29    refreshTable    ${scroll_count}    4
    \    #Sleep    1

checkFilters
    [Arguments]    ${tab}    ${page_rows}    ${table_column}   ${filter_data}
    Sleep    4
    ${rows}=    Set Variable    ${page_rows}
    log    Row Count = ${rows}    WARN
    : FOR    ${row}    IN RANGE    0    ${rows}
    \    ${data}=    Get Text    //md-tab-content[${tab}]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[@row="${row}"]/div[${table_column}]/span/span
    \    Should Be Equal    ${data}    ${filter_data}
    \    ${scroll_count}=    Run Keyword if    int(${row})>=30    getScrollCount    ${row}
    \    Run Keyword if    int(${row})>29    refreshTable    ${scroll_count}    2

getTableRow
    sleep    4
    ${table}=    Get Table Cell    xpath=//table[starts-with(@items,"inventories")]    1    1
    #Number of rows and columns
    ${rows}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th[1]/div/div/div[1]
    ${cols}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th
    ${cols}=    Set Variable    10
    ${rows}=    Set Variable    10
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    ${table}=    Set Variable    xpath=//table[starts-with(@items,"inventories")]
    : FOR    ${row}    IN RANGE    1    ${rows}+2
    \    @{contents}=    getCellValue    ${row}    ${cols}    ${table}
    \    Log List    ${contents}
    \    Append To File    WebTestingInventoryTmp.csv    ${contents}[0]
    \    Append To File    WebTestingInventoryTmp.csv    "\n"

getCellValue
    [Arguments]    ${row}    ${cols}    ${table}
    @{rowContent}=    Create List
    : FOR    ${col}    IN RANGE    1    ${cols}+1
    \    ${val}=    Get Table Cell    ${table}    ${row}    ${col}
    \    Append To List    ${rowContent}    ${val}
    Return From Keyword    @{rowContent}
