*** Settings ***
Library           Selenium2Library
Library           Collections
Library           OperatingSystem
Library           MyLibrary
Library           String
Library           EmailLibrary

*** Test Cases ***
Login to SM Workbench
    [Tags]    a
    Close All Browsers
    Selenium2Library.Open Browser    http://d-jss-app.jnpr.net:50080/jss-ciat/app/home    firefox
    Comment    Maximize Browser Window
    Input Text    j_username    demo
    Input Password    j_password    demo
    Click Button    submit
    Page Should Contain    Welcome

Navigate to SM Workbench Page
    [Tags]    a
    Mouse Over    externalNav
    Click Element    xpath=//li[@id="smWorkbenchNav"]/a
    sleep    10
    #Page Should Contain    Account Selector
    Page Should Contain    Inventories

Verify Tabs Loading
    [Tags]    a
    Sleep    2
    Select Frame    id=smWorkbenchPage
    sleep    4
    Input Text    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/div/div[1]/div/oi-select/div[1]/ul/li[1]/input    Juniper-IT
    sleep    2
    Click Element    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/div/div[1]/div/oi-select/div[2]/ul/li
    sleep    3
    Element Should Be Visible    //button[starts-with(@class, 'md-raised')]/span[contains(text(), "Download")]
    #Click Element    //button[starts-with(@class, 'md-raised')]/span[contains(text(), "Show Inventory")]
    Sleep    3
    #Element Should Be Visible    //button[starts-with(@class, 'md-raised')]/span[contains(text(), "Export Inventory")]
    ${firstVal}=    Get Text    //md-tab-item[1][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${seconVal}=    Get Text    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${thirdVal}=    Get Text    //md-tab-item[3][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${fourthVal}=    Get Text    //md-tab-item[4][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    ${fifthVal}=    Get Text    //md-tab-item[5][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Should Be Equal    ${firstVal}    CONTRACT
    Should Be Equal    ${seconVal}    INVENTORY
    Should Be Equal    ${thirdVal}    FRU TO CHASSIS MAP
    Should Be Equal    ${fourthVal}    SOFTWARE ANALYSIS
    Should Be Equal    ${fifthVal}    EOL

Verify INVENTORY Table Header Information
    [Tags]    i
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    Sleep    2
    Should Be Equal    ${Device Name}    Device Name
    Should Be Equal    ${Module}    Module
    Should Be Equal    ${Sub Module}    Sub Module
    Should Be Equal    ${Sub Sub Module}    Sub Sub Module
    Should Be Equal    ${Sub Sub Sub Module}    Sub Sub Sub Module
    Should Be Equal    ${Part Number}    Part Number
    Should Be Equal    ${Model Number}    Model Number
    Should Be Equal    ${Serial Number}    Serial Number
    Should Be Equal    ${Product}    Product
    Should Be Equal    ${Platform}    Platform
    Should Be Equal    ${Revision}    Revision
    Should Be Equal    ${Description}    Description

Verify INVENTORY Data
    [Tags]    i
    Sleep    5
    Create File    C:\\tmp\\ASWorkbench\\WebTesting\\Inventory.csv
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    Set Global Variable    ${total}    ${count}
    Set Global Variable    ${counter}    0
    : FOR    ${page}    IN RANGE    1    ${pages}+1
    \    getInventoryDivTableRow
    \    Click Element    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    \    Sleep    5
    #\    Run Keyword If    ${page}<=${pages}    Exit For Loop

Verify INVENTORY Filtering based on Platform
    [Tags]    ia
    Sleep    5
    Click Element    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[1]/div[2]/div/div[9]/span
    Sleep    5
    Wait Until Element Is Visible    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    srx
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${Device Name}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[1]/div[2]/span[4]
    ${Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[2]/div[2]/span[2]
    ${Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[3]/div[2]/span[2]
    ${Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[4]/div[2]/span[2]
    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[5]/div[2]/span[2]
    ${Part Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[6]/div[2]/span[2]
    ${Model Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[7]/div[2]/span[2]
    ${Serial Number}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[8]/div[2]/span[2]
    ${Product}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[9]/div[2]/span[2]
    ${Platform}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[10]/div[2]/span[2]
    ${Revision}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[11]/div[2]/span[2]
    ${Description}=    Get Text    //md-tab-content[@id="tab-content-2"]/div/div/md-content/div/md-content/div/div/div/div/div/div[@id="center"]/div/div/div/div/div/div/div[12]/div[2]/span[2]
    ${count}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[3]
    ${pages}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/span[2]
    log    pages = ${pages}    WARN
    : FOR    ${page}    IN RANGE    1    ${pages}+1
    \    log    pages = ${page}    WARN
    \    1etInventoryDivTableRow1
    \    Click Element    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[2]/button[3]
    #\    Run Keyword If    ${page}<=${pages}+1    Exit For Loop

Verify INVENTORY Columns Settings
    [Tags]    ia
    Sleep    4
    Mouse Over    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-trigger/button
    #Wait Until Element Is Visible    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    Sleep    4
    Click Button    //div[@layout="column"]/md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    ${settings_columns_header}    Get Text    //div[@id="east"]/div/div/div/div/div
    ${number_of_columns}    Get Matching Xpath Count    //div[@id="east"]/div/div/div/div/div/div/div/span/span[2]
    ${serialId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[1]/span/span[2]
    ${contractId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[2]/span/span[2]
    ${product}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[3]/span/span[2]
    ${platform}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[4]/span/span[2]
    ${sku}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[5]/span/span[2]
    ${skuClassification}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[6]/span/span[2]
    ${status}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[7]/span/span[2]
    ${startDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[8]/span/span[2]
    ${endDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[9]/span/span[2]
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date

Verify INVENTORY Column Selection
    [Tags]    ia
    # Disabling all columns
    Log    Disabling all columns
    Sleep    4
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Should Not Be Equal    ${contractId}    Contract Id
    Should Not Be Equal    ${product}    Product
    Should Not Be Equal    ${platform}    Platform
    Should Not Be Equal    ${sku}    SKU
    Should Not Be Equal    ${skuClassification}    SKU Classification
    Should Not Be Equal    ${status}    Status
    Should Not Be Equal    ${startDate}    Start Date
    Should Not Be Equal    ${endDate}    End Date
    Sleep    3
    Log    Enable all columns
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    # Disable column "Serial Id"
    Log    Disabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Sleep    3
    Log    Enabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3

Verify CONTRACT Table Header Information
    [Tags]    c
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    Click Element    //md-tab-item[1][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    ${count}=    Get Text    //div[@id="south"]/div/span/span[3]
    Sleep    2
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date
    #Should Be Equal    ${count}    Count

Verify CONTRACT Filtering based on Product
    [Tags]    c
    Sleep    5
    Click Element    //div[@id="borderLayout_eGridPanel"]/div/div/div/div/div/div[3]/span[@class="ag-header-cell-menu-button"]
    Sleep    5
    Wait Until Element Is Visible    //div[@id="borderLayout_eRootPanel"]/div[3]    timeout=5
    Input Text    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[2]/input    srx
    Click Button    //div[@id="borderLayout_eRootPanel"]/div[3]/div/div[3]/button[1]
    Sleep    5
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[1]/span
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[2]/span
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[3]/span
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[4]/span
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[5]/span
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[6]/span
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[7]/span
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[8]/span
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div[9]/span
    ${count}=    Get Text    //div[@id="south"]/div/span/span[3]
    ${pages}=    Get Text    //div[@id="south"]/div/span[2]/span[2]
    : FOR    ${page}    IN RANGE    1    ${pages}
    \    getDivTableRow
    \    Click Element    //div[@id="south"]/div/span[2]/button[@id="btNext"]
    \    Sleep    5
    \    Run Keyword If    ${pages}<${pages}    Exit For Loop

Verify CONTRACT Columns Settings
    [Tags]    c
    Sleep    4
    Mouse Over    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-trigger/button
    #Wait Until Element Is Visible    //md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    Sleep    4
    Click Button    //div[@layout="column"]/md-content[@class="md-default-theme"]/div[4]/div[2]/md-fab-speed-dial/md-fab-actions/div[2]/button
    ${settings_columns_header}    Get Text    //div[@id="east"]/div/div/div/div/div
    ${number_of_columns}    Get Matching Xpath Count    //div[@id="east"]/div/div/div/div/div/div/div/span/span[2]
    ${serialId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[1]/span/span[2]
    ${contractId}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[2]/span/span[2]
    ${product}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[3]/span/span[2]
    ${platform}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[4]/span/span[2]
    ${sku}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[5]/span/span[2]
    ${skuClassification}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[6]/span/span[2]
    ${status}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[7]/span/span[2]
    ${startDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[8]/span/span[2]
    ${endDate}=    Get Text    //div[@id="east"]/div/div/div/div/div/div/div[9]/span/span[2]
    Should Be Equal    ${serialId}    Serial Number
    Should Be Equal    ${contractId}    Contract Id
    Should Be Equal    ${product}    Product
    Should Be Equal    ${platform}    Platform
    Should Be Equal    ${sku}    SKU
    Should Be Equal    ${skuClassification}    SKU Classification
    Should Be Equal    ${status}    Status
    Should Be Equal    ${startDate}    Start Date
    Should Be Equal    ${endDate}    End Date

Verify CONTRACT Column Selection
    [Tags]    c
    # Disabling all columns
    Log    Disabling all columns
    Sleep    4
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[2]/div/span[2]
    ${product}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[3]/div/span[2]
    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[4]/div/span[2]
    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[5]/div/span[2]
    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[6]/div/span[2]
    ${status}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[7]/div/span[2]
    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[8]/div/span[2]
    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[9]/div/span[2]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Should Not Be Equal    ${contractId}    Contract Id
    Should Not Be Equal    ${product}    Product
    Should Not Be Equal    ${platform}    Platform
    Should Not Be Equal    ${sku}    SKU
    Should Not Be Equal    ${skuClassification}    SKU Classification
    Should Not Be Equal    ${status}    Status
    Should Not Be Equal    ${startDate}    Start Date
    Should Not Be Equal    ${endDate}    End Date
    Sleep    3
    Log    Enable all columns
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[2]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[3]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[4]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[5]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[6]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[7]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[8]/span/span[1]
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[9]/span/span[1]
    Sleep    3
    # Disable column "Serial Id"
    Log    Disabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3
    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div/div/div/div[1]/div/span[4]
    Sleep    2
    Should Not Be Equal    ${serialId}    Serial Number
    Sleep    3
    Log    Enabling column "Serial Id"
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span
    Click Element    //div[@id="east"]/div/div/div[2]/div/div/div/div[1]/span/span[1]
    Sleep    3

Verify Graph
    Comment    Mouse Over    //*/div[@id='pieChart']
    Sleep    3
    Comment    Selenium2Library.Wait Until Element Is Visible    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/md-tabs/md-tabs-content-wrapper/md-tab-content[1]/div/md-content/div[2]/div[1]/div[1]/svg
    ${entitleInfo}=    Get Element Attribute    xpath= //*/div[@id='pieChart']/*[name()='svg']/*[name()='g']/*[name()='g']/*[name()='path']@fill
    Log    ${entitleInfo}    WARN
    Should Be Equal    ${entitleInfo}    ACTIVE: 100%
    Comment    ${totalActive}=    Get Text    xpath=//*/div[@id='pieChart']/*[name()='svg']/*[name()='g']/*[name()='g']/*[name()='text']
    Should Be Equal    ${totalActive}    ACTIVE(1219)
    ${bar}=    Set Variable    31
    : FOR    ${count}    IN RANGE    ${bar}+1
    \    ${number}=    Get Text    //div[@id='barChart']//*[local-name() = 'svg']/*[name()='g'][1]/*[name()='text'][${count}]
    \    ${model}=    Get Text    //div[@id='barChart']//*[local-name() = 'svg']/*[name()='g'][2]/*[name()='text'][${count}]
    \    ${LOG_FILE}    ${model}    ${number}

View Inventory For Account
    Click Element    //md-tab-item[2][starts-with(@class, 'md-tab ng-scope ng-isolate-scope')]/span[@class='ng-scope']
    Sleep    5
    ${headerCount}=    Get Matching Xpath Count    //table[@items='inventories']/thead/tr/th
    #Should Be Equal    ${headerCount}    10
    ${col1}=    Get Text    //table[@items='inventories']/thead/tr/th[1]/div/div/div[1]
    ${col2}=    Get Text    //table[@items='inventories']/thead/tr/th[2]/div/div/div[1]
    ${col3}=    Get Text    //table[@items='inventories']/thead/tr/th[3]//div[@class='tr-ng-title ng-binding']
    ${col4}=    Get Text    //table[@items='inventories']/thead/tr/th[4]//div[@class='tr-ng-title ng-binding']
    ${col5}=    Get Text    //table[@items='inventories']/thead/tr/th[5]//div[@class='tr-ng-title ng-binding']
    ${col6}=    Get Text    //table[@items='inventories']/thead/tr/th[6]//div[@class='tr-ng-title ng-binding']
    ${col7}=    Get Text    //table[@items='inventories']/thead/tr/th[7]//div[@class='tr-ng-title ng-binding']
    ${col8}=    Get Text    //table[@items='inventories']/thead/tr/th[8]//div[@class='tr-ng-title ng-binding']
    ${col9}=    Get Text    //table[@items='inventories']/thead/tr/th[9]//div[@class='tr-ng-title ng-binding']
    ${col10}=    Get Text    //table[@items='inventories']/thead/tr/th[10]//div[@class='tr-ng-title ng-binding']
    Should Be Equal    ${col1}    Device Name
    Should Be Equal    ${col2}    Module
    Should Be Equal    ${col3}    Sub_Module
    Should Be Equal    ${col4}    Sub_Sub_Module
    Should Be Equal    ${col5}    Sub_Sub_Sub_Module
    Should Be Equal    ${col6}    Part Number
    Should Be Equal    ${col7}    Model Number
    Should Be Equal    ${col8}    Serial Number
    Should Be Equal    ${col9}    Revision
    Should Be Equal    ${col10}    Description

Inventory Validation
    sleep    4
    ${table}=    Get Table Cell    xpath=//table[starts-with(@items,"inventories")]    1    1
    log    ${table}
    #Number of rows and columns
    ${rows}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th[1]/div/div/div[1]
    ${cols}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th
    ${cols}=    Set Variable    10
    ${rows}=    Set Variable    10
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    Click Element    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/md-tabs/md-tabs-content-wrapper/md-tab-content[2]/div/md-content/div[2]/md-content/div/table/tfoot/tr/td/div/div/div/span[3]/ul/li[6]/a
    Sleep    3
    ${total}=    Get Text    xpath=//*[@id="tab-content-002"]/div/md-content/div[2]/md-content/div/table/tfoot/tr/td/div/div/div/span[3]/ul/li[8]/span[2]/span
    ${total}=    Get Substring    ${total}    2    -9
    Log    ${total}    WARN
    ${total}=    Evaluate    ${total}/10
    Log    ${total}    WARN
    Create File    WebTestingInventoryTmp.csv
    Append To File    WebTestingInventoryTmp.csv    [u'Device Name', u'Module', u'Sub_Module', u'Sub_Sub_Module', u'Sub_Sub_Sub_Module', u'Part Number', u'Revision', u'Model Number', u'Serial Number', u'Description']
    : FOR    ${row}    IN RANGE    1    ${total}
    \    getTableRow
    \    Run Keyword If    ${row}>=2    Exit For Loop
    \    Click Element    xpath=/html/body/div/div/div/div[2]/div/div/div/div[2]/adf-widget-content/md-tabs/md-tabs-content-wrapper/md-tab-content[2]/div/md-content/div[2]/md-content/div/table/tfoot/tr/td/div/div/div/span[3]/ul/li[6]/a
    \    Sleep    3
    Copy File    D:\\GuiAutomation\\RIDE\\SM_Workbench\\Hadoop_Applications\\WebTestingInventoryTmp.csv    C:\\tmp\\WebTesting\\
    Prepare File For Inventory Mapping    WebTestingInventoryTmp.csv
    Compare Inventory    WebTestingInventory.csv

Logout and Close
    Unselect Frame
    Click Link    xpath=/html/body/div[2]/div/table/tbody/tr[2]/td/a
    Wait Until Page Contains    Login    timeout=10
    Close Browser

SendMail
    Prepare Report For Email    Juniper    C:/tmp
    Send Mail With Attachment    pbiswas@juniper.net    pbiswas@juniper.net    Automation Test Results    Please find the attached results    C:/tmp/RIDE-report.zip

*** Keywords ***
getDivTableRow
    sleep    4
    ${table}    Set Variable    xpath=//div[@id="center"]/div/div/div/div[2]/div[2]
    # Number of rows and columns
    ${rows}=    Get Matching Xpath Count    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div
    ${cols}=    Get Matching Xpath Count    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div/div/span
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    : FOR    ${row}    IN RANGE    1    ${rows}
    \    Log    ${row}
    \    ${serialId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[1]/span
    \    ${contractId}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[2]/span
    \    ${product}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[3]/span
    \    ${platform}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[4]/span
    \    ${sku}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[5]/span
    \    ${skuClassification}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[6]/span
    \    ${status}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[7]/span
    \    ${startDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[8]/span
    \    ${endDate}=    Get Text    //div[@id="center"]/div/div/div/div[2]/div[2]/div/div/div[${row}]/div[9]/span
    \    #Should Contain    ${product}    srx
    #\    Log    ${serialId}
    #\    Append To File    WebTestingInventoryTmp.csv    ${contents}[0]
    #\    Append To File    WebTestingInventoryTmp.csv    "\n"

getInventoryDivTableRow
    sleep    4
    # Number of rows and columns
    #${rows}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[2]/div/span[1]/span[2]
    ${rows}=    Set Variable    10
    ${cols}=    Set Variable    12
    ${ctr}=    Evaluate    int(int(${counter})+int(${rows}))
    Set Global Variable    ${counter}    ${ctr}
    ${rows}=    Run Keyword If    int(${counter})>int(${total})    getRowCounter    ELSE    getRows
    log    Counter = ${counter}    WARN
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    log    Total = ${total}    WARN
    : FOR    ${row}    IN RANGE    1    ${rows}+1
    \    Log    ${row}
    \    ${Device Name}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[1]/span/span/span/span[3]
    \    ${Module}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[2]/span/span
    \    ${Sub Module}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[3]/span/span
    \    ${Sub Sub Module}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[4]/span/span
    \    ${Sub Sub Sub Module}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[5]/span/span
    \    ${Part Number}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[6]/span/span
    \    ${Model Number}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[7]/span/span
    \    ${Serial Number}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[8]/span/span
    \    ${Product}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[9]/span/span
    \    ${Platform}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[10]/span/span
    \    ${Revision}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[11]/span/span
    \    ${Description}=    Get Text    //md-tab-content[2]/div/div/md-content/div/md-content/div/div[1]/div/div/div[1]/div[2]/div/div[1]/div/div[2]/div[2]/div/div/div[${row}]/div[12]/span/span
    \    ${record}=    Create List    ${Module}    ${Sub Module}    ${Sub Sub Module}    ${Sub Sub Sub Module}
    \    ...    ${Part Number}    ${Model Number}    ${Serial Number}    ${Product}    ${Platform}
    \    ...    ${Revision}    ${Description}
    \    Append To File    C:\\tmp\\ASWorkbench\\WebTesting\\Inventory.csv    ${record}[0]
    \    Append To File    C:\\tmp\\ASWorkbench\\WebTesting\\Inventory.csv    "\n"

getRowCounter
    Return From Keyword    int(int(${counter})-int(${total}))

getRows
    ${rows}=    Set Variable    10
    Return From Keyword    ${rows}

getTableRow
    sleep    4
    ${table}=    Get Table Cell    xpath=//table[starts-with(@items,"inventories")]    1    1
    #Number of rows and columns
    ${rows}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th[1]/div/div/div[1]
    ${cols}=    Get Matching Xpath Count    //table[@items='inventories' and @fields="config.visibleColumns['inventory'].selected"]/thead/tr/th
    ${cols}=    Set Variable    10
    ${rows}=    Set Variable    10
    log    Row Count = ${rows}    WARN
    log    Col Count = ${cols}    WARN
    ${table}=    Set Variable    xpath=//table[starts-with(@items,"inventories")]
    : FOR    ${row}    IN RANGE    1    ${rows}+2
    \    @{contents}=    getCellValue    ${row}    ${cols}    ${table}
    \    Log List    ${contents}
    \    Append To File    WebTestingInventoryTmp.csv    ${contents}[0]
    \    Append To File    WebTestingInventoryTmp.csv    "\n"

getCellValue
    [Arguments]    ${row}    ${cols}    ${table}
    @{rowContent}=    Create List
    : FOR    ${col}    IN RANGE    1    ${cols}+1
    \    ${val}=    Get Table Cell    ${table}    ${row}    ${col}
    \    Append To List    ${rowContent}    ${val}
    Return From Keyword    @{rowContent}
